<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Resizing Docker for Mac Without the UI | Alec Reynolds</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="tl;dr If you&#39;re getting the error &quot;No space left on device&quot; that prevents you from starting Docker for Mac, you need to resize your Docker for Mac image. Steps below.

In trying to put together a ...">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.2578eea2.css" as="style"><link rel="preload" href="/assets/js/app.7fcca07b.js" as="script"><link rel="preload" href="/assets/js/4.53f59e22.js" as="script"><link rel="preload" href="/assets/js/1.802703d6.js" as="script"><link rel="preload" href="/assets/js/29.10847f87.js" as="script"><link rel="prefetch" href="/assets/js/11.f529fa5f.js"><link rel="prefetch" href="/assets/js/12.3bf82c44.js"><link rel="prefetch" href="/assets/js/13.6ea8a656.js"><link rel="prefetch" href="/assets/js/14.fdad2801.js"><link rel="prefetch" href="/assets/js/15.e8c6836d.js"><link rel="prefetch" href="/assets/js/16.f8ceaa4d.js"><link rel="prefetch" href="/assets/js/17.12977942.js"><link rel="prefetch" href="/assets/js/18.ecbcbf8b.js"><link rel="prefetch" href="/assets/js/19.7f2099ab.js"><link rel="prefetch" href="/assets/js/2.38f9b6da.js"><link rel="prefetch" href="/assets/js/20.a43afb99.js"><link rel="prefetch" href="/assets/js/21.535cafbb.js"><link rel="prefetch" href="/assets/js/22.ba44bbdb.js"><link rel="prefetch" href="/assets/js/23.54d00ad0.js"><link rel="prefetch" href="/assets/js/24.76678610.js"><link rel="prefetch" href="/assets/js/25.1aa2c4f8.js"><link rel="prefetch" href="/assets/js/26.e4f27dd0.js"><link rel="prefetch" href="/assets/js/27.88aa07f3.js"><link rel="prefetch" href="/assets/js/28.332a2d5f.js"><link rel="prefetch" href="/assets/js/3.20ac2743.js"><link rel="prefetch" href="/assets/js/30.094b5a43.js"><link rel="prefetch" href="/assets/js/31.5ff9faf1.js"><link rel="prefetch" href="/assets/js/32.90eb1544.js"><link rel="prefetch" href="/assets/js/33.3ab521a4.js"><link rel="prefetch" href="/assets/js/34.b857de01.js"><link rel="prefetch" href="/assets/js/35.c670f08c.js"><link rel="prefetch" href="/assets/js/36.0177c088.js"><link rel="prefetch" href="/assets/js/37.0ac838bc.js"><link rel="prefetch" href="/assets/js/38.706d1a02.js"><link rel="prefetch" href="/assets/js/5.8c869777.js"><link rel="prefetch" href="/assets/js/6.a36a5a51.js"><link rel="prefetch" href="/assets/js/7.bb47ed10.js"><link rel="prefetch" href="/assets/js/8.fde1d220.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.eaf10578.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2578eea2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Alec Reynolds </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Home</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Alec Reynolds </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Home</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        Resizing Docker for Mac Without the UI
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2021-12-03T22:55:00.000Z">
      Fri Dec 03 2021
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/dev tools" data-v-42ccfcd5><span data-v-42ccfcd5>dev tools</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p><strong>tl;dr If you're getting the error &quot;No space left on device&quot; that prevents you from starting Docker for Mac, you need to resize your Docker for Mac image. Steps below.</strong></p> <p>In trying to put together a code example showing bad Docker performance on MacOS when booting an application that serves many small files, I accidentally ran my Docker for Mac VM <em>completely</em> out of space.</p> <p>Normally getting a &quot;No space left on device&quot; isn't a big deal in Docker on a Mac device. You can either clear out space by pruning some volumes/images/whatever is taking up space, or you can resize your Docker for Mac instance through the &quot;Preferences&quot; screen.</p> <p>However, in my case after a system restart I was unable to start Docker for Mac, presumably because the underlying virtual machine (the hypervisor that runs Docker) was SO out of space, it couldn't bootstrap! This meant I could neither run <code>docker</code> itself to clear out space OR use the GUI to resize the image.</p> <p>To make matters worse, I didn't want to uninstall my entire Docker instance, since I still had some images running that would take time to replace.</p> <p>Fortunately, the solution wasn't too painful. These are the steps I took to fix the problem and get Docker for Mac running again.</p> <h2 id="_1-find-your-docker-raw"><a href="#_1-find-your-docker-raw" class="header-anchor">#</a> 1. Find your Docker.raw</h2> <div class="language- extra-class"><pre class="language-text"><code>cd ~/Library/Containers/com.docker.docker/Data/vms/0/data
ls
</code></pre></div><p>You should see a <code>Docker.raw</code> here. this location should be consistent as of this writting, but you'll notice that older guides mention a <code>Docker.qemu2</code>...that's either out of date now or only relevant when Docker for Mac is running (which we're assuming it's not in this guide, otherwise you wouldn't have this problem).</p> <h2 id="_2-install-gparted-qemu"><a href="#_2-install-gparted-qemu" class="header-anchor">#</a> 2. Install gparted + qemu</h2> <p>For gparted, go to http://gparted.org/download.php and select the most recent amd64 release.</p> <p>For qemu, <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Homebrew<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> should have you covered:</p> <div class="language- extra-class"><pre class="language-text"><code>brew update
brew install qemu
</code></pre></div><h2 id="_3-use-qemu-to-resize-the-image-and-start-the-virtual-environment"><a href="#_3-use-qemu-to-resize-the-image-and-start-the-virtual-environment" class="header-anchor">#</a> 3. Use qemu to resize the image and start the virtual environment</h2> <p>These commands basically create a new partition with extra space within the virtual environment Docker runs within:</p> <div class="language- extra-class"><pre class="language-text"><code>qemu-img info Docker.raw   # shows you current disk size
qemu-img resize Docker.raw +20G  # make it 20GB larger
qemu-img info Docker.raw    # check the new size
qemu-system-x86_64 -drive file=Docker.raw  -m 512 -cdrom ~/Downloads/gparted-live-WHATEVERYOURVERSIONIS -boot d -device usb-mouse -usb
</code></pre></div><h2 id="_4-use-gparted-to-merge-that-partition-with-your-existing-one"><a href="#_4-use-gparted-to-merge-that-partition-with-your-existing-one" class="header-anchor">#</a> 4. Use gparted to merge that partition with your existing one.</h2> <p>Here are the instructions from the <a href="https://gist.github.com/stefanfoulis/5bd226b25fa0d4baedc4803fc002829e" target="_blank" rel="noopener noreferrer">original guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> I followed, which are still true:</p> <blockquote><p>Wait for the VM to boot (can take a long time). For any questions asked (boot option, keyboard layout, language) the default is ok. Double click the gparted Icon. You should see swap space, the main partition and 100GB of free space. Select the main partition. Click Resize in the toolbar and drag the partition limit to fill the whole space. Click Apply. Wait for it to finish resizing and then quit the app and shutdown the gparted machine. Now start Docker for Mac again.</p></blockquote> <p>I foolishly didn't take good screenshots, but here's one that shows the steps once you get gparted running:</p> <p><img src="/images/gparted-example.png" alt="gparted visual steps"></p> <h2 id="_5-restart-docker-for-mac"><a href="#_5-restart-docker-for-mac" class="header-anchor">#</a> 5. Restart Docker for Mac</h2> <p>If all has gone well, you should now have extra space and no more errors!</p> <p>I reconstructed my steps from this old gist, 99% of credit goes to the good folks who made it: https://gist.github.com/stefanfoulis/5bd226b25fa0d4baedc4803fc002829e</p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#_1-find-your-docker-raw" title="1. Find your Docker.raw">1. Find your Docker.raw</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_2-install-gparted-qemu" title="2. Install gparted + qemu">2. Install gparted + qemu</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_3-use-qemu-to-resize-the-image-and-start-the-virtual-environment" title="3. Use qemu to resize the image and start the virtual environment">3. Use qemu to resize the image and start the virtual environment</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_4-use-gparted-to-merge-that-partition-with-your-existing-one" title="4. Use gparted to merge that partition with your existing one.">4. Use gparted to merge that partition with your existing one.</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#_5-restart-docker-for-mac" title="5. Restart Docker for Mac">5. Restart Docker for Mac</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7fcca07b.js" defer></script><script src="/assets/js/4.53f59e22.js" defer></script><script src="/assets/js/1.802703d6.js" defer></script><script src="/assets/js/29.10847f87.js" defer></script>
  </body>
</html>
